@startuml models_diagram_final
' Diagrama de Modelos Final - Alta Normalização e Padrão Snake Case
' skinparam linetype ortho

' Tabelas de Domínio / Lookup
entity tipos_parceiro {
  * id : int (PK)
  --
  descricao : varchar(50) {unique}
}

entity status_job {
  * id : int (PK)
  --
  descricao : varchar(50) {unique}
}

entity status_lancamento {
  * id : int (PK)
  --
  descricao : varchar(50) {unique}
}

entity tipos_lancamento {
  * id : int (PK)
  --
  descricao : varchar(50) {unique}
}

' Tabelas Principais
entity empresas {
  * id : int (PK)
  --
  nome : varchar(255)
  cnpj : varchar(18) {unique}
}

entity parceiros {
  * id : int (PK)
  --
  #tipo_parceiro_id : int (FK)
  nome : varchar(255)
  cnpj : varchar(18) {unique}
}

entity jobs_processamento {
  * id : int (PK)
  --
  #empresa_id : int (FK)
  #status_job_id : int (FK)
  arquivo_original : varchar(255)
  dt_criacao : timestamptz
  dt_conclusao : timestamptz
  mensagem_erro : text
}

entity notas_fiscais {
  * id : int (PK)
  --
  #job_processamento_id : int (FK)
  #parceiro_id : int (FK)
  numero : varchar(100)
  data_emissao : date
  valor_total : numeric(10,2)
}

entity lancamentos_financeiros {
  * id : int (PK)
  --
  #nota_fiscal_id : int (FK)
  #tipo_lancamento_id : int (FK)
  #status_lancamento_id : int (FK)
  descricao : varchar(255)
  valor : numeric(10,2)
  data_vencimento : date
  data_pagamento : date
}

' Relacionamentos
empresas ||--|{ jobs_processamento
parceiros ||--o{ notas_fiscais

tipos_parceiro ||--|{ parceiros
status_job ||--|{ jobs_processamento

jobs_processamento ||--|{ notas_fiscais
notas_fiscais ||--o{ lancamentos_financeiros

tipos_lancamento ||--|{ lancamentos_financeiros
status_lancamento ||--|{ lancamentos_financeiros

@enduml